1. @PRD.md 파일을 확인하고 요약해줘.  
2. 플레이어 캐릭터 설정과 관련하여 구현된 내용들을 요약해줘.  
3. 플레이어 캐릭터 설정과 관련하여 문제점 및 개선해야 할 점 들을 정리해줘.
   
   
### PRD.md 파일 요약
1. Loreless는 AI 융합 턴제 전략 RPG 프로젝트로, 다음과 같은 주요 내용을 담고 있습니다:
	- 게임은 플레이어가 기억을 잃은 상태로 시작하며 대화를 통해 캐릭터 배경을 재구성
	- 클라이언트 주도, 서버 보조 아키텍처 구조 사용
	- AI 시스템은 플레이어 캐릭터 설정, 전투 시스템, NPC 대화 응답 생성 기능 제공
	- 기술 스택으로 Python 3.11, FastAPI, Google Gemini, PostgreSQL 사용
	- AI 서버는 프롬프트 구성 및 외부 모델 호출 담당

2. 플레이어 캐릭터 설정 구현 내용:
	현재 코드베이스에서 확인된 플레이어 캐릭터 설정 관련 구현 내용은 다음과 같습니다:
	- 기본적인 캐릭터 생성 기능이 app/services/characters.py에 구현됨
	- create_character 함수를 통해 사용자 ID, 캐릭터 이름, 직업, 성별, 특성을 입력받아 캐릭터 생성
	- 직업별 기본 스탯(전사, 궁수)이 하드코딩되어 있음
	- 전투 시스템에서 캐릭터 정보를 활용하는 기능 구현됨(app/ai/combat.py)
	- NPC와의 기본 대화 시스템이 app/ai/npc_chat.py에 구현됨

3. 플레이어 캐릭터 설정 관련 문제점 및 개선점:
	- 현재 코드베이스에서 PRD에 명시된 "NPC와 나누는 자연스러운 대화를 기반으로 AI가 캐릭터 정보(종족, 직업, 성격 태그, 스탯, 초기 스킬)를 종합해 생성하는" 기능이 완전히 구현되지 않은 것으로 보입니다.
	- 현재는 단순한 캐릭터 생성과 기본적인 NPC 대화 시스템만 구현되어 있어, PRD에서 제시한 대화 기반의 동적 캐릭터 생성 기능을 완성하기 위한 추가 개발이 필요합니다.
	개선해야 할 점:
	- NPC 대화를 통한 플레이어 캐릭터 정보 추출 및 생성 로직 부재
	- 기억을 잃은 상태의 스토리텔링과 연계된 캐릭터 설정 기능 미구현
	- 대화 내용을 분석하여 종족, 직업, 성격 태그를 추론하는 AI 로직 필요
	- 스탯 값을 동적으로 생성하는 알고리즘 필요
	- 대화 기록을 저장하고 캐릭터 설정에 반영하는 시스템 필요
	- 캐릭터 생성 과정에서 플레이어의 선택과 AI 추론을 결합하는 인터페이스 필요


---
NPC와 나누는 자연스러운 대화를 기반으로 AI가 캐릭터 정보(특성 @trait.json, 스탯, 초기 스킬 @skill.json)를 종합해 생성하는 기능을 구현할꺼야. @profile.py 부분에 해당 기능부터 구현해줘. 프롬프트의 경우 우선은 기존 구조를 따라서 @loader.py쪽에 작성해줘.  
1. 종족과 직업은 우선 빼.  
2. 특성의 경우 가장 적합한 특성 최대 2개만 부여할꺼야.  
3. 스탯의 경우 @characters.py CharacterStatsUpdateRequest 클래스의 요소들을 참고해.
   

가장 어려웠던 점은 **적절한 문맥을 추출하는 과정**이었습니다. 처음에는 문단 단위로만 검색했지만, 문맥 범위가 넓거나 핵심 문장을 놓치는 문제가 있었습니다. 이를 해결하기 위해 **문장 단위로 유사도를 검색한 후, 해당 문장이 속한 상위 문단을 복원하는 로직**을 직접 설계했습니다. LangChain의 ParentDocumentRetriever 같은 계층적 검색 모듈이 있다는 점은 나중에 알게 되었지만, 직접 구축하는 과정을 통해 **RAG 구조를 깊이 이해하고 검색 정확도를 향상**시킬 수 있었습니다.